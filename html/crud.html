<!DOCTYPE html>
<html lang="en">

<head>
    <title>Blog Posts</title>
    <meta charset="UTF-8">
    <meta name="description" content="Blog Posts page of my personal website">
    <meta name="author" content="Jingxian Wang">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
	<!-- <h1>Blog Posts</h1> -->
	
    <section id="main_post">
        <h2 id="starter">You can add your posts!</h2>
    </section>
	

    <!-- Create blog post -->
    <dialog id="create_dialog">
        <p id="create_message"></p>
        <form id="add-post-form" method="dialog" autocomplete="off">
            <div>
              <label for="post_title">Blog Title</label>
              <input type="text" id="post_title">
              <!-- <output id="output_title"></output> -->
            </div>
            <div>
              <label for="post_date">Date</label>
              <input type="date" id="post_date">
              <!-- <output id="output_date"></output> -->
            </div>
            <div>
              <label for="post_summary">Summary</label>
              <textarea id="post_summary"></textarea>
              <!-- <output id="output_summary"></output> -->
            </div>
            <button id="create_btn" type="submit">Create</button>
            <button id="cancel_btn">Cancel</button>
          </form>
    </dialog>

    <button id="create">Create</button>

    <dialog id="custom_confirm_dialog">
        <p id="confirm_message"></p>
        <button id="yes_btn">Yes</button>
        <button id="no_btn">Cancel</button>
    </dialog>

    <script type="module">
        import { createPost, customConfirm } from '/javascripts/blog.js';
        document.getElementById('create').addEventListener('click', async () => {

            // <!-- Create blog post -->
            const result = await createPost("Please enter your blog:");
            console.log(result);
            if (Array.isArray(result)) {
                document.getElementById('starter').textContent = ''
                
                const title = result[0];
                const date = result[1];
                const summary = result[2];
                const post = document.createElement('article');
                post.innerHTML = `
                    <h2>${title}</h2>
                    <p>Date: ${date}</p>
                    <p>Summary: ${summary}</p>
                    <button class="delete_btn">Delete</button>
                `;
                document.getElementById('main_post').appendChild(post);
                // document.insertAfter(post, document.getElementById('main_post'));
                // referenceNode.parentNode.insertBefore(post, referenceNode.document.getElementById('main_post'));
                // document.getElementById('title_output').textContent = title;
                // document.getElementById('date_output').textContent = date;
                // document.getElementById('summary_output').textContent = summary;

                // <!-- Delete blog post -->
                console.log(document.getElementsByClassName('delete_btn'));
                const deleteBtn = post.querySelector('.delete_btn');
                deleteBtn.addEventListener('click', async () => {
                    let input = await customConfirm('Are you sure you want to delete it?');
                    console.log(input)
                    if (input) {
                        post.remove(); // remove the parent div element
                    }
                });

                
                // <!-- Edit blog post -->
            }
        });
    </script>


    <!-- <footer>
        <p class="footer"> &copy; Jingxian Wang </p>
    </footer> -->
</body>
</html>